const cartilhaContent = {
    apresentacao: {
        titulo: "Apresenta√ß√£o",
        conteudo: `A Secretaria de Estado de Meio Ambiente - SEMA/MT, por meio de sua Superintend√™ncia de Educa√ß√£o Ambiental tem como principal objetivo informar a todos, de forma simples e clara, como podem contribuir para a conserva√ß√£o da biodiversidade do nosso Estado.

Acreditamos que esta Cartilha disponibilizar√° conhecimentos √† popula√ß√£o sobre a legisla√ß√£o ambiental, possibilitando a atua√ß√£o efetiva dos mato-grossenses na prote√ß√£o do meio ambiente.

A cartilha faz parte de um jogo educativo que apresenta informa√ß√µes sobre a forma legal de realizar a disposi√ß√£o correta dos res√≠duos s√≥lidos, prote√ß√£o florestal e dos recursos pesqueiros.

<div class="section-title">Elabora√ß√£o:</div>
- Elaine Corsini - Analista de Meio Ambiente 
- Vict√≥ria de M. Arruda da Costa - Analista de Meio Ambiente

<div class="section-title">Diagrama√ß√£o:</div>
- Beatriz Mikulski da Silva - Estagi√°ria 
- Vict√≥ria de M. Arruda da Costa - Analista de Meio Ambiente

<div class="section-title">Desenvolvimento do Jogo Digital:</div>
- Guilherme Justiniano da Silva
- Jo√£o Heitor Kozow Bittencourt Bertoloto
- Kauan Douglas de Matos Barbosa
- Keven Eduardo Vaz Bilibio
- Matheus Henrique L√¥bo Alves
- Rafael de Lima Almeida

Secretaria de Estado de Meio Ambiente de Mato Grosso
Fique legal com o Meio Ambiente

Contato: susa@sema.mt.gov.br`
    },
    pesca: {
        titulo: "Pesca Legal",
        conteudo: `Pescar apenas em local e per√≠odo permitido

Para mantermos a sa√∫de dos rios e a reprodu√ß√£o dos peixes, √© fundamental respeitar os locais e per√≠odos de pesca permitidos.

Carteira de Pescador Amador ou Pescador Profissional
Ao pescar, n√£o se esque√ßa de portar a carteira que comprova sua permiss√£o para a atividade.

Peixes fora da medida
Se voc√™ pescar um peixe que n√£o est√° dentro da medida permitida, devolva-o imediatamente ao rio. Essa atitude garante a reprodu√ß√£o da esp√©cie e a alegria de outros pescadores no futuro.

Menores de 18 anos
Se voc√™ tem menos de 18 anos, fique tranquilo! Voc√™ tamb√©m pode pescar, desde que esteja acompanhado dos pais ou respons√°veis e tenha a autoriza√ß√£o necess√°ria.

Per√≠odo de defeso (Piracema)
Voc√™ sabe o que √© o per√≠odo de defeso? √â quando a pesca √© proibida para proteger os peixes durante a reprodu√ß√£o. Em Mato Grosso, a piracema acontece de outubro a janeiro.

Modalidades de pesca permitidas
Em Mato Grosso, existem diversas modalidades de pesca permitidas, como a cient√≠fica, amadora, profissional artesanal, desportiva, profissional, de subsist√™ncia e subaqu√°tica. Informe-se sobre cada uma delas e escolha a que mais se adequa √†s suas necessidades e prefer√™ncias.

<div class="section-title">Utilize a tabela abaixo como guia e pratique a pesca consciente:</div>

<h4>Peixes e suas Medidas (cm):</h4>
- Bicuda: 60
- Caranha: 45
- Chimbur√©: 25
- Dourada: 80
- J√°u: 95
- Matrinx√£: 35
- Pirapitinga: 45
- Pirarara: 90
- Piau: 25
- Piraputanga: 30
- Barbado: 60
- Cachara: 80
- Cachorra: 60
- Curimbat√°: 30
- Jurupens√©m: 35
- Pacu-peva: 45
- Pintado do Paraguai: 40
- Placa do Paraguai: 45
- Plavu√ßu: 200

O que n√£o √© legal na pesca:

√â proibido:
- Pescar no per√≠odo de defeso (piracema)
- Pescar e transportar peixes abaixo da medida m√≠nima e acima da quantidade permitida, ou sem a carteirinha de pescador
- Capturar iscas vivas e de peixes nativos para fins ornamentais e de aquariofilia, a 1.000 metros de ninhais (Lei n¬∫ 9.096/2009)
- Pescar com subst√¢ncias t√≥xicas ou explosivos
- Pescar por meio de deriva√ß√£o de cursos d'√°gua ou esgotamento de lagos de dom√≠nio p√∫blico
- Fazer cevas fixas permanentes ou com uso de equipamentos mec√¢nicos irregulares para pescaria colocados no leito do rio
- Capturar, comercializar e transportar as esp√©cies Dourado e Pira√≠ba ou Filhote no estado de Mato Grosso
- Pescar a 200 metros abaixo ou acima de barragens, corredeiras, cachoeiras e escadas de peixes e desembocadura de ba√≠as
- Pescar no interior das Unidades de Conserva√ß√£o`
    },
    queimadas: {
        titulo: "Queimadas e Inc√™ndios Florestais",
        conteudo: `Um dos grandes problemas que assolam Mato Grosso todos os anos s√£o as queimadas e os inc√™ndios florestais. Descubra o que fazer para a prote√ß√£o das florestas.

O que n√£o √© legal em rela√ß√£o √†s queimadas:

- Realizar queimadas no per√≠odo proibitivo, do dia 1¬∫ de julho a 31 de outubro, por ser o per√≠odo mais seco do ano a aumentar o risco de inc√™ndios florestais
- √â expressamente proibido fazer qualquer queimada sem autoriza√ß√£o
- Queimar vegeta√ß√£o nativa
- Queimar √Årea de Reserva Legal - ARL
- Queimar √Årea de Preserva√ß√£o Permanente - APP
- Causar inc√™ndios florestais (fogo sem controle)
- A queimada no per√≠metro urbano √© proibida durante todo o ano

Recomenda√ß√µes importantes:
- Fa√ßa sempre o aceiramento para evitar que o fogo acabe queimando as √°reas de preserva√ß√£o permanente, reservas legais e √°reas de uso restrito
- A queima em canaviais e em restos de explora√ß√µes florestais (desmatamento) s√≥ poder√£o ser realizadas com autoriza√ß√£o pr√©via da SEMA
- N√£o utilizar fogo para manejar o seu solo, busque t√©cnicas alternativas

Consequ√™ncias das queimadas e dos inc√™ndios:
- Altera√ß√£o na qualidade do ar
- Aumento dos casos de doen√ßas respirat√≥rias
- Redu√ß√£o da biodiversidade e do habitat da fauna e flora silvestres
- Redu√ß√£o da fertilidade dos solos
- Aumento da emiss√£o de gases de efeito estufa para a atmosfera
- Fechamento de estradas e aeroportos em fun√ß√£o da baixa visibilidade
- Aumento do risco de acidentes
- Morte de animais silvestres`
    },
    vegetacao: {
        titulo: "Prote√ß√£o da Vegeta√ß√£o",
        conteudo: `<div class="section-title">S√£o √Åreas de Preserva√ß√£o Permanente - APP</div>

<div class="section-subtitle">Todo c√≥rrego ou rio deve ter uma faixa de vegeta√ß√£o nativa (APP) em suas margens, o tamanho da faixa varia conforme a largura do curso d'√°gua:</div>

- Cursos d'√°gua de menos de 10 metros de largura: APP de 30 metros
- Cursos d'√°gua de 10 a 50 metros de largura: APP de 50 metros
- Cursos d'√°gua de 50 a 200 metros de largura: APP de 100 metros
- Cursos d'√°gua de 200 a 600 metros de largura: APP de 200 metros
- Cursos d'√°gua acima de 600 metros de largura: APP de 500 metros

As lagoas e lagos naturais devem ter uma faixa de vegeta√ß√£o em seu entorno (APP) de:
- Em zonas rurais: 100 metros
- Em zonas urbanas: 30 metros
- Lagos ou reservat√≥rios artificiais: definido pela licen√ßa ambiental

Outras APPs importantes:
- Nascentes e olhos d'√°gua: raio m√≠nimo de 50 metros
- Encostas com declividade superior a 45¬∫
- Bordas de tabuleiros ou chapadas: m√≠nimo de 100 metros
- Veredas: m√≠nimo de 50 metros
- Topo de morros, montes, montanhas e serras com altura m√≠nima de 100 metros e inclina√ß√£o m√©dia maior que 25¬∫

O que n√£o √© legal na APP:
- Desmatar √Åreas de Preserva√ß√£o Permanente
- Substituir a vegeta√ß√£o original por esp√©cies ex√≥ticas
- Construir em √°reas de APP
- Utilizar as √°reas de APP para agricultura, pecu√°ria ou cria√ß√£o de outros animais
- Barrar os cursos d'√°gua sem autoriza√ß√£o da SEMA

Import√¢ncia das APPs:
- Fonte de alimento para peixes
- Manuten√ß√£o da qualidade e quantidade da √°gua
- Fonte de abrigo e alimenta√ß√£o para a fauna silvestre
- Corredores ecol√≥gicos para fauna
- Manuten√ß√£o da biodiversidade
- Evita a contamina√ß√£o dos cursos d'√°gua
- Manuten√ß√£o do len√ßol fre√°tico`
    },
    reservalegal: {
        titulo: "Reserva Legal",
        conteudo: `A Reserva Legal - RL √© uma √°rea localizada no interior de uma propriedade rural, onde deve ser mantida a vegeta√ß√£o nativa, tendo como objetivo: promover a conserva√ß√£o da biodiversidade, prote√ß√£o de fauna silvestre e da flora nativa.

Como calcular a Reserva Legal:
- Propriedades em √°reas de floresta: 80% da √°rea do im√≥vel
- Propriedades em √°reas de cerrado: 35% da √°rea do im√≥vel
- Propriedades com mais de um tipo de vegeta√ß√£o: considerar os percentuais de cada tipo

O que n√£o √© legal na Reserva Legal:
- Realizar desmatamento e queimada
- Explorar madeira sem aprova√ß√£o na SEMA
- Substituir a vegeta√ß√£o nativa por vegeta√ß√£o ex√≥tica
- Modificar a destina√ß√£o da Reserva Legal em caso de venda da propriedade

√Årea de Uso Restrito - AUR:
S√£o de dois tipos:
1. Pantanais e plan√≠cies pantaneiras
2. √Åreas de inclina√ß√£o entre 25¬∫ e 45¬∫

O que n√£o √© legal na AUR:
- Realizar desmatamento da vegeta√ß√£o nativa
- Obstruir ou desviar rios, lagoas, corixos e vazantes
- Realizar drenagem dos campos inund√°veis
- Introduzir esp√©cies ex√≥ticas
- Realizar aterros e escava√ß√µes nas √°reas inund√°veis`
    },
    residuos: {
        titulo: "Res√≠duos S√≥lidos",
        conteudo: `Todos n√≥s produzimos diariamente uma grande quantidade de res√≠duos s√≥lidos (lixo), e √† medida que a popula√ß√£o cresce, este volume aumenta ainda mais, demandando cada vez mais √°reas maiores para a disposi√ß√£o desses res√≠duos.

A Pol√≠tica dos 5 Rs do Minist√©rio do Meio Ambiente:
- REPENSAR - Ter um consumo consciente
- RECUSAR - Avaliar produtos e recusar embalagens n√£o recicl√°veis
- REDUZIR - Gerar menos res√≠duos e evitar desperd√≠cios
- REUTILIZAR - Dar novo uso aos materiais
- RECICLAR - Transformar materiais usados em novos produtos

Dicas para aplicar os 5 Rs:
- N√£o compre o que voc√™ n√£o precisa
- D√™ prefer√™ncia a produtos que tem refil
- Evite produtos descart√°veis
- Leve sua sacola ao supermercado
- Guarde seu lixo at√© encontrar onde descartar corretamente
- Doe roupas e sapatos ao inv√©s de jogar no lixo
- Compre alimentos na quantidade necess√°ria
- Use correio eletr√¥nico
- Imprima usando os dois lados do papel

O que n√£o √© legal fazer com os Res√≠duos S√≥lidos:
- Jogar lixo nas ruas e rios
- Jogar lixo em terrenos baldios
- Queimar res√≠duos s√≥lidos
- Descartar incorretamente pilhas, baterias, l√¢mpadas e aeross√≥is
- Jogar eletr√¥nicos no lixo comum

A solu√ß√£o est√° nas m√£os de cada um de n√≥s. Pratique o consumo consciente e a destina√ß√£o correta dos res√≠duos!`
    }
};

function showCartilha() {
    const modal = document.createElement('div');
    modal.id = 'cartilhaModal';
    modal.className = 'modal';
    modal.style.display = 'block'; // Garantir que o modal seja vis√≠vel
    
    // Prevenir scroll do body quando a cartilha estiver aberta
    document.body.style.overflow = 'hidden';
    
    const content = document.createElement('div');
    content.className = 'modal-content cartilha-content';
    
    const closeBtn = document.createElement('button');
    closeBtn.className = 'close-button';
    closeBtn.innerHTML = '&times;';
    closeBtn.onclick = (e) => {
        e.preventDefault();
        e.stopPropagation();
        modal.style.display = 'none';
        modal.remove();
        document.body.style.overflow = ''; // Restaurar scroll do body
    };
    
    // Melhorar manipula√ß√£o de eventos touch
    modal.addEventListener('touchmove', (e) => {
        if (e.target === modal) {
            e.preventDefault(); // Prevenir scroll do background
        }
    }, { passive: false });
    
    // Fechar modal quando clicar fora do conte√∫do
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.style.display = 'none';
            modal.remove();
            document.body.style.overflow = '';
        }
    });
    
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.parentElement) {
            modal.style.display = 'none';
            modal.remove();
            document.body.style.overflow = '';
        }
    });
    
    const nav = document.createElement('nav');
    nav.className = 'cartilha-nav';
    
    Object.keys(cartilhaContent).forEach(section => {
        const btn = document.createElement('button');
        btn.textContent = cartilhaContent[section].titulo;
        btn.onclick = () => showSection(section);
        nav.appendChild(btn);
    });
    
    const sectionContent = document.createElement('div');
    sectionContent.className = 'cartilha-section';
    
    content.appendChild(closeBtn);
    content.appendChild(nav);
    content.appendChild(sectionContent);
    modal.appendChild(content);
    
    document.body.appendChild(modal);
    showSection('apresentacao'); // Mostrar primeira se√ß√£o por padr√£o
}

function showSection(sectionId) {
    const sectionContent = document.querySelector('.cartilha-section');
    const section = cartilhaContent[sectionId];
    const buttons = document.querySelectorAll('.cartilha-nav button');
    
    // Atualizar bot√£o ativo
    buttons.forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent === section.titulo) {
            btn.classList.add('active');
        }
    });

    // Formatar o conte√∫do para melhor apresenta√ß√£o
    let formattedContent = section.conteudo
        // Formatar listas numeradas: identifica linhas iniciadas com d√≠gitos e ponto
        .replace(/^\s*\d+\.\s*(.+)$/gm, '<li class="numlist">$1</li>')
        // Formatar listas com h√≠fen
        .replace(/^- (.+)$/gm, '<li>$1</li>')
        // Envolver itens numerados com <ol>
        .replace(/((?:<li class="numlist">.*<\/li>\n?)+)/g, '<ol>$1</ol>')
        // Envolver demais listas com <ul>
        .replace(/((?:<li>(?!class).*<\/li>\n?)+)/g, '<ul>$1</ul>')
        // Formatar subt√≠tulos com marcadores coloridos
        .replace(/^([A-Z][^:\n]+):$/gm, '<h3><span class="section-marker marker-blue">‚Ä¢</span>$1</h3>')
        // Formatar subt√≠tulos normais (sem marcador)
        .replace(/^([^-\n<][^:\n]+):$/gm, '<h4>$1:</h4>')
        // Destacar dicas
        .replace(/^DICA:(.*)$/gim, '<div class="tip-box">üí° Dica:$1</div>')
        // Destacar alertas
        .replace(/(!importante:.*$)/gim, '<div class="alert-box">‚ö†Ô∏è Importante:$1</div>')
        // Destacar informa√ß√µes
        .replace(/(Observa√ß√£o:.*$)/gim, '<div class="important-box">‚ÑπÔ∏è Observa√ß√£o:$1</div>')
        // Destacar palavras-chave entre asteriscos
        .replace(/\*([^*]+)\*/g, '<span class="emphasis">$1</span>')
        // Formatar par√°grafos
        .replace(/\n\n/g, '</p><p>')
        // Destacar n√∫meros e medidas com limites de palavra
        .replace(/\b(\d+(?:\s*(?:metros|cm|%|anos))?)\b/g, '<strong>$1</strong>')
        // Formatar t√≠tulos de se√ß√£o com marcador azul
        .replace(/<div class="section-title">([^<]+)<\/div>/g, '<h3><span class="section-marker marker-blue">‚Ä¢</span>$1</h3>');

    // Envolver em par√°grafos se ainda n√£o estiver
    if (!formattedContent.startsWith('<p>')) {
        formattedContent = `<p>${formattedContent}</p>`;
    }

    // Nova estrutura de formata√ß√£o para a cartilha
    sectionContent.innerHTML = `
    <article class="cartilha-article fade-in">
        <header class="cartilha-article-header">
            <h2>${section.titulo}</h2>
        </header>
        <div class="cartilha-text">
            ${formattedContent}
        </div>
        <footer class="cartilha-article-footer">
            <p>Fonte: Secretaria de Estado de Meio Ambiente de Mato Grosso</p>
        </footer>
    </article>
    `;

    // Scroll suave para o topo ao mudar de se√ß√£o
    sectionContent.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}
